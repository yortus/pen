/*
 * egs:
 *      2+3*5
 *      42*(333-2)
 */


{memoise, i32, textOnly} = import 'std'


start = expr


expr = memoise(add | sub | term)
add = {type: 'add',  lhs: expr,  rhs: textOnly("+") term} // NB: commas allowed but optional
sub = {type: 'sub'   lhs: expr   rhs: textOnly("-") term}

term = memoise(mul | div | factor)
mul = {type: 'mul'   lhs: term   rhs: textOnly("*") factor}
div = {type: 'div'   lhs: term   rhs: textOnly("/") factor}

factor = i32 | "(" expr ")"
