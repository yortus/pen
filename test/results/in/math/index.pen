/*
 * egs:
 *      2+3*5
 *      42*(333-2)
 */


{memoize, i32} = import 'std'


export math = expr


expr = memoize(add | sub | term)
add = {type: 'add',  lhs: expr,  rhs: "+" term} // NB: commas allowed but optional
sub = {type: 'sub'   lhs: expr   rhs: "\-" term}

term = memoize(mul | div | factor)
mul = {type: 'mul'   lhs: term   rhs: "*" factor}
div = {type: 'div'   lhs: term   rhs: "/" factor}

factor = i32 | "(" expr ")"
